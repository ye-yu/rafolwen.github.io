<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style media="screen">
  html {
    scroll-behavior:smooth;
  }

  .input-notes {
    background-color: rgb(0, 204, 204);
  }

  .output-notes {
    background-color: rgb(255, 51, 0);
    color: white;
  }

  .input-notes-text {
    color: rgb(0, 204, 204);
    background-color: #F9F9F9;
  }

  .output-notes-text {
    color: rgb(255, 51, 0);
    background-color: #F9F9F9;
  }

  td {
     vertical-align: top;
     padding: 1rem 5px;
  }

  .absolute-bottom {
    position: sticky;
    margin: auto;
    bottom: 1.2rem;
  }

  .absolute-top {
    position: sticky;
    margin: auto;
    top: 1.2rem;
  }

  .overflow-x-auto {
    overflow-x: auto;
  }

</style>
<div class="container">
  <div class="row">
    <div class="col text-center py-5"
          style="border-bottom: solid 5px lightblue;">
      <div class="display-3">
        Extending Singing Music Samples with AI
      </div>
      <div class="">
        Recurrent Neural Network (RNN) has been a recently popular approach in
        temporal-data modelling such as predicting stock market and even
        generating sequences. In this survey, I will present to you a few
        outputs of singing voice with AI from two different models architecture,
        and you get to vote your opinion on the quality of the generated
        outputs.

        <br>
        <br>
        <a href="#vote">Skip to Voting Section</a>
      </div>
    </div>
  </div>

  <div class="row py-3">
    <div class="col">
      <div class="card">
        <div class="card-body">
          <div class="card-title h4">Project and Survey Summary</div>
          <!-- <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> -->
          <p class="card-text">
            The goal of this research is to build a machine learning model that can
            continue the composition of the given input singing melody. This model
            is supported by a collection of open-source software that helps to
            convert the raw audio format into data type that the model can
            understand and learn.
          </p>
          <p class="card-text">
            There are already existing implementations on continuing music
            composition. However, this project focuses on singing voice melody
            that is naturally monophonic, which achieves different goals than
            the other kinds of implementation. To compare model architectures,
            I trained two kinds of model: model with several layers of LSTM, and
            a Sequence-to-Sequence model with Bahdanau attention. To listen to
            the raw audio inputs, feel free to check out this link
            <a href="https://www.youtube.com/playlist?list=PLHVwmyuGAjJ-OnBO9dKrNsnmmj7WAXDv0"
               target="_blank"> over here</a>.
          </p>
          <p class="card-text">
            This survey can identify the quality of the generated outputs from
            two different model architectures. To avoid biases, the main target
            audience for this survey includes everyone who has no prior
            knowledge to such mechanism in generating sequences, and the
            questions are shuffled randomly. However, outliers are tolerated
            moderately.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="p-3 mb-2 bg-info text-white d-flex flex-row align-items-center">
    <div class="d-inline-block pb-1 pr-3">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
           viewBox="0 0 24 24" fill="none" stroke="currentColor"
           stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
           class="feather feather-alert-circle">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
    </div>
    <div class="d-inline-block">
      This survey may take around 5 to 20 minutes depending on how many questions do you choose to answer.
      <br>
      However, it is highly appreciated to have at least 5 questions answered carefully.
    </div>
  </div>

  <div class="row mt-5">
    <div class="col">
      <div class="h3">
        Clip Information
      </div>
      <hr>
      <div class="">
        <p>
          There are <b>15</b> different clips, but you can freely choose any clips
          that you want to vote.
          Each clip displays the musical notes that are sung by the voice
          synthesizer while playing the audio of the singing voice.
          The singing voice synthesizer only sing one syllable &mdash; "duh".
        </p>
        <p>
          These notes
          are color-coded into two categories:
        </p>
        <ul class="list-group pb-1"
            style="max-width:30rem;">
          <li class="list-group-item">
            <div class="d-inline px-1 input-notes">
            Notes</div>
            in this color are <u>given to</u> the AI model.
          </li>
          <li class="list-group-item">
            <div class="d-inline px-1 output-notes">
            Notes</div>
            in this color are <u>generated by</u> the AI model.
          </li>
        </ul>
      </div>

      <div class="h3 pt-5" id="vote">
        Voting Instructions
      </div>
      <hr>
      <p>
        You are required to vote based on the following scoring system:
      </p>
      <table border="0">
        <tr class="border-bottom border-top">
          <td>
            <b>Consistency</b>
          </td>
          <td>
            The direction from the
            <span class="input-notes-text px-1">input melody</span>
            to the
            <span class="output-notes-text px-1">generated melody</span>
            makes sense.
          </td>
        </tr>

        <tr class="border-bottom">
          <td>
            <b>Composition</b>
          </td>
          <td>
            The
            <span class="output-notes-text px-1">generated melody</span>
            is comparable to human composition, or it is realistic.
          </td>
        </tr>

        <tr class="border-bottom">
          <td>
            <b>Creativity</b>
          </td>
          <td>
            The
            <span class="output-notes-text px-1">generated melody</span>
            is interesting and innovative, or it is not spitting out garbage nor
            producing random melody.
          </td>
        </tr>

        <tr class="border-bottom">
          <td>
            <b>Preference</b>
          </td>
          <td>
            The
            <span class="input-notes-text pl-1">whole</span><span class="output-notes-text px-1">clip</span>
            is likeable.
          </td>
        </tr>
      </table>

      <p class="mt-2">
        To indicate the performance on each score shown above, you are required
        to assign one of the following labels to the score as described below:
      </p>

      <div class="container-fluid">
        <div class="row">

          <div class="col-lg mx-lg-1 mx-2">
            <div class="card" style="background-color: #ffe6e6; height: 100%;">
              <div class="card-body">
                <h5 class="card-title font-weight-bold">Weak</h5>
                <p class="card-text">
                  The performance for this score is not meaningful, or it does not contribute any value to this score.
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg mx-lg-1 mx-2">
            <div class="card" style="background-color: #fff2e6; height: 100%;">
              <div class="card-body">
                <h5 class="card-title font-weight-bold">Elementary</h5>
                <p class="card-text">
                  The performance is slightly meaningful or does contribute little value to this score.
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg mx-lg-1 mx-2">
            <div class="card" style="background-color: #ffffcc; height: 100%;">
              <div class="card-body">
                <h5 class="card-title font-weight-bold">Debatable</h5>
                <p class="card-text">
                  The performance can contribute some values to this score if we cherry-picked some parts of the generated melody.
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg mx-lg-1 mx-2">
            <div class="card" style="background-color: #eeffcc; height: 100%;">
              <div class="card-body">
                <h5 class="card-title font-weight-bold">Good</h5>
                <p class="card-text">
                  The performance needs less improvements on this score, or the flaw of the performance in this score is negligible.
                </p>
              </div>
            </div>
          </div>

          <div class="col-lg mx-lg-1 mx-2">
            <div class="card" style="background-color: #ccffcc; height: 100%;">
              <div class="card-body">
                <h5 class="card-title font-weight-bold">Excellent</h5>
                <p class="card-text">
                  The performance is outstanding on this score.
                </p>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="my-5 display-3 text-center">
    AI Generated Singing Music Clips
  </div>

  <div id="progress-group">
    <div class="progress mb-1" height="5px">
      <div class="progress-bar progress-bar-striped progress-bar-animated"
           role="progressbar" aria-valuenow="1" aria-valuemin="0"
           aria-valuemax="100" style="width: 1%" id="iframe-progress"
           style="-webkit-transition: none;transition: none;"></div>
    </div>
    <div class="text-center text-muted mb-5">
      Loading clips...
    </div>
  </div>

  <button type="button" class="mx-auto d-block btn btn-secondary" name="button" onclick="randomizeOnClick();">
    &#8635; Randomize
  </button>

  <hr class="my-5">

  <div class="container-fluid" id="voting-section">
  </div>

  <hr class="my-1" id="pdc-divider">

  <div class="mt-5 pb-3 display-4 text-center">
    Consensual Personal Data Collection
  </div>
  <div class="mb-5 font-weight-bold text-center text-muted" style="font-size: 0.8rem;">
    These information are anonymous and unidentifiable. However, this is not mandatory, and you are free to skip this section.
  </div>

  <hr class="my-5">

  <form id="pdc-section">
  </form>

  <div class="absolute-bottom" id="complete-evaluation-button">
    <button type="button"
            class="btn btn-primary"
            name="button"
            id="submit-button"
            onclick="submitResponse()">
      Complete Evaluation &#187;
    </button>
  </div>

  <div class="d-flex flex-column text-center mt-5 mx-auto"
       style="font-size: 0.75rem; max-width: 50rem;">
    <div class="">
      <b>Fair Use Notice</b>
    </div>
    <div class="">
      <p>
        This project may have used copyrighted contents without the right authorization from their respective owners. These contents are only for educational and research purposes and may be identified in some part of the contents in this survey. This is by no means collecting any monetary benefits from using these contents.
      </p>
      <p>
        Further discussions can be issued through this link:
        <a href="https://github.com/ye-yu/cac-svs/issues" target="_blank">
          GitHub Repo Issues
        </a>
      </p>
    </div>
  </div>
</div>

<div style="visibility: hidden;">
  <form action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfJr2nX7CSplUzr0po5uvppMv50gkZ48orVL2XYuVFQEWjUNQ/formResponse"
        method="POST"
        id="mG61Hd">
    <input type="text" name="entry.1086921046" id="evaluation-events">
    <input type="text" name="entry.1933991603" id="personal-data-events">
    <button type="submit" class="btn btn-primary" id="submit-form">Submit</button>
  </form>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
			  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
			  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<script type="text/javascript">
  "use strict";
  $.fn.shuffleChildren = function() {
    $.each(this.get(), function(index, el) {
      var $el = $(el);
      var $find = $el.children();

      $find.sort(function() {
        return 0.5 - Math.random();
      });

      $el.empty();
      $find.appendTo($el);
    });
  };

  const COMPLETE_EVALUATION = "Complete Evaluation Â»";
  let SKIP_PDC = "Skip Personal Data Collection";
  const ERROR_MSG = "(Please provide at least one answer.)";

  let rows = [
    {
      name: "seq2seq-clip-01",
      video: "TPCEgsqiyD0"
    },
    {
      name: "seq2seq-clip-02",
      video: "F4Tl6vyGZcU"
    },
    {
      name: "seq2seq-clip-03",
      video: "l-pvfqvp0xs"
    },
    {
      name: "seq2seq-clip-04",
      video: "p1I94i-tEfU"
    },
    {
      name: "seq2seq-clip-05",
      video: "2QUoSI0bvfQ"
    },
    {
      name: "seq2seq-clip-06",
      video: "rH6PpS4-IS0"
    },
    {
      name: "seq2seq-clip-short-01",
      video: "bm2qfx8FWCI"
    },
    {
      name: "seq2seq-clip-short-02",
      video: "RpVyWsSROlk"
    },
    {
      name: "seq2seq-clip-short-03",
      video: "HVz5fd_G5N0"
    },
    {
      name: "lstm-clip-01",
      video: "-UR0OH-FDzs"
    },
    {
      name: "lstm-clip-02",
      video: "-9VtcjMM-_s"
    },
    {
      name: "lstm-clip-03",
      video: "yG2VwQoUGuU"
    },
    {
      name: "lstm-clip-04",
      video: "vMZrprmPwxM"
    },
    {
      name: "lstm-clip-05",
      video: "a0QVsz_qD60"
    },
    {
      name: "lstm-clip-06",
      video: "HDsthD95KaE"
    },
  ]

  let rowObjs = [];

  let evaluationObj={};
  let personalDataObj= {};

  for(let row of rows) {
    let name = row.name;
    let video = row.video;
    let template = `
    <div class="row align-items-center">
      <div class="col-lg-3">
        <iframe width="250px"
                height="188px"
                style="display: block; margin: auto;"
                src="https://www.youtube-nocookie.com/embed/${video}"
                frameborder="0"
                allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
      </div>
      <div class="col-lg pl-3">
        <div class="container-fluid my-4">
          <div class="row">

            <div class="col-lg border">
              <div class="font-weight-bold text-center text-lg-left py-3">
                Consistency
              </div>
              <div class="pb-3">
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:consistency" value="weak"> <span class="px-2"> Weak </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:consistency" value="elementary"> <span class="px-2"> Elementary </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:consistency" value="debatable"> <span class="px-2"> Debatable </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:consistency" value="good"> <span class="px-2"> Good </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:consistency" value="excellent"> <span class="px-2"> Excellent </span> <br>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg border">
              <div class="font-weight-bold text-center text-lg-left py-3">
                Composition
              </div>
              <div class="pb-3">
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:composition" value="weak"> <span class="px-2"> Weak </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:composition" value="elementary"> <span class="px-2"> Elementary </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:composition" value="debatable"> <span class="px-2"> Debatable </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:composition" value="good"> <span class="px-2"> Good </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:composition" value="excellent"> <span class="px-2"> Excellent </span> <br>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg border">
              <div class="font-weight-bold text-center text-lg-left py-3">
                Creativity
              </div>
              <div class="pb-3">
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:creativity" value="weak"> <span class="px-2"> Weak </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:creativity" value="elementary"> <span class="px-2"> Elementary </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:creativity" value="debatable"> <span class="px-2"> Debatable </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:creativity" value="good"> <span class="px-2"> Good </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:creativity" value="excellent"> <span class="px-2"> Excellent </span> <br>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg border">
              <div class="font-weight-bold text-center text-lg-left py-3">
                Preference
              </div>
              <div class="pb-3">
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:preference" value="weak"> <span class="px-2"> Weak </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:preference" value="elementary"> <span class="px-2"> Elementary </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:preference" value="debatable"> <span class="px-2"> Debatable </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:preference" value="good"> <span class="px-2"> Good </span> <br>
                  </div>
                </div>
                <div class="input-group-prepend">
                  <div class="input-group-text w-100 mb-1">
                    <input type="radio" class="voting-option" name="${name}:preference" value="excellent"> <span class="px-2"> Excellent </span> <br>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
    <hr class="mt-3">
    `;
    rowObjs.push($(template));
  }

  function detachRowObjs() {
    $("#voting-section").children().detach();
  }

  function appendRowObjs() {
    updateProgressBar(5);
    $("#progress-group").fadeIn();
    let loadedIframes = 0;
    const TOTAL_IFRAMES = rows.length;

    let n = 1;
    const SECS = 850;

    for(let row of rowObjs) {
      setTimeout(() => {
        $("#voting-section").append(row);
        $(".voting-option").on("click", (e) => updateEvaluationData(e));
        $("iframe").on('load', () => {
          let prog = Math.ceil(((++loadedIframes)/TOTAL_IFRAMES) * 100);
          updateProgressBar(prog);
        });
      }, (n++) * SECS);
    }

  }

  function shuffle(array) {
    var currentIndex = array.length, temporaryValue, randomIndex;

    // While there remain elements to shuffle...
    while (0 !== currentIndex) {

      // Pick a remaining element...
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex -= 1;

      // And swap it with the current element.
      temporaryValue = array[currentIndex];
      array[currentIndex] = array[randomIndex];
      array[randomIndex] = temporaryValue;
    }

    return array;
  }

  function updatePdcOnElement(e, textConstraintById) {
    SKIP_PDC = `(Additional Info Included) ${COMPLETE_EVALUATION}`;
    $("#submit-button").html(SKIP_PDC);

    if (textConstraintById !== undefined) {
      let element = $('#' + textConstraintById);
      let name = element.attr('name');
      let value = element.val();
      personalDataObj[name][value] = e.checked;
      return;
    }

    let type = e.attributes.getNamedItem('stype').value;
    let reference = e.attributes.getNamedItem('reference');
    let name = e.name;
    let value = e.value;

    if (type == 'checkbox') {
      if (personalDataObj[name] === undefined) {
        personalDataObj[name] = {};
      }

      personalDataObj[name][value] = e.checked;

      if (reference !== null) {
        delete personalDataObj[name][reference.value];
        $(e).attr('reference', value);
        personalDataObj[name][value] = document.getElementById(`${e.attributes.getNamedItem('update-check-on').value}`).checked;
      }
    } else {
      personalDataObj[name] = value;
    }
  }

  function randomizeRowObjs() {
    rowObjs = shuffle(rowObjs);
  }


  function updateEvaluationData(e) {
    $("#submit-button").html(COMPLETE_EVALUATION);
    let attributes = e.currentTarget;
    let nameScore = attributes.name.split(":");
    let name = nameScore[0];
    let score = nameScore[1];
    let value = attributes.value;
    if (evaluationObj[name] === undefined) {
      evaluationObj[name] = {};
    }

    evaluationObj[name][score] = value;
  }

  function submitResponse() {
    let y = $(document).scrollTop();
    let t = $("#pdc-divider").offset().top - window.innerHeight;
    if (y < t) {
      if ($("#submit-button").html() != `${ERROR_MSG} ${COMPLETE_EVALUATION}`) {
        location.hash = "pdc-divider";
      }
    } else {
      if (Object.keys(evaluationObj).length > 0) {
        $("#evaluation-events").val(JSON.stringify(evaluationObj));
        $("#personal-data-events").val(JSON.stringify(personalDataObj));
        $("#submit-form").click();
      } else {
        location.hash = "voting-section";
        $("#submit-button").html(`${ERROR_MSG} ${COMPLETE_EVALUATION}`);
      }
    }
  }

  function randomizeOnClick() {
    detachRowObjs();
    randomizeRowObjs();
    appendRowObjs();
  }

  let pdcQuestions = [
  {
    "question": "What device are you using to answer this survey?",
    "name": "device",
    "options": [
      {
        "type": "radio",
        "text": "Mobile Device"
      },
      {
        "type": "radio",
        "text": "Widescreen Device"
      },
      {
        "type": "radio",
        "otherOption": true
      }
    ]
  },
  {
    "question": "Are you aware of computer-generated singing voice like Hatsune Miku?",
    "name": "know-svs",
    "options": [
      {
        "type": "radio",
        "text": "Yes"
      },
      {
        "type": "radio",
        "text": "No"
      }
    ]
  },
  {
    "question": "What era of music do you often listen to?",
    "name": "era",
    "options": [
      {
        "type": "checkbox",
        "text": "Classical songs"
      },
      {
        "type": "checkbox",
        "text": "80s songs"
      },
      {
        "type": "checkbox",
        "text": "90s songs"
      },
      {
        "type": "checkbox",
        "text": "Latest songs"
      },
      {
        "type": "checkbox",
        "otherOption": true
      }
    ]
  },
  {
    "question": "Which region are you from?",
    "name": "region",
    "options": [
      {
        "type": "radio",
        "text": "America"
      },
      {
        "type": "radio",
        "text": "Africa"
      },
      {
        "type": "radio",
        "text": "America"
      },
      {
        "type": "radio",
        "text": "Asia & Pacific"
      },
      {
        "type": "radio",
        "text": "Arab States"
      },
      {
        "type": "radio",
        "text": "Europe"
      }
    ]
  },
  {
    "question": "What is your level of knowledge in music theory?",
    "name": "know-music-theory",
    "options": [
      {
        "type": "radio",
        "text": "Not applicable (Having no idea how music is formed)"
      },
      {
        "type": "radio",
        "text": "Elementary (Knowing how to sing, not pitch-deaf, etc)"
      },
      {
        "type": "radio",
        "text": "Intermediate (Self-taught)"
      },
      {
        "type": "radio",
        "text": "Intermediate (Attended class/tutors)"
      },
      {
        "type": "radio",
        "text": "Advanced (Musical prodigy)"
      }
    ]
  },
  {
    "question": "Which fields of study are you mostly interested in?",
    "name": "study-fields",
    "options": [
      {
        "type": "checkbox",
        "text": "Visual Arts"
      },
      {
        "type": "checkbox",
        "text": "Game Industry"
      },
      {
        "type": "checkbox",
        "text": "Engineering"
      },
      {
        "type": "checkbox",
        "text": "Carpenting"
      },
      {
        "type": "checkbox",
        "text": "Literature"
      },
      {
        "type": "checkbox",
        "text": "Communication"
      },
      {
        "type": "checkbox",
        "text": "Music"
      },
      {
        "type": "checkbox",
        "text": "Business"
      },
      {
        "type": "checkbox",
        "text": "Biology"
      },
      {
        "type": "checkbox",
        "text": "Information Technology"
      },
      {
        "type": "checkbox",
        "text": "Mathematics"
      },
      {
        "type": "checkbox",
        "otherOption": true
      }
    ]
  },
  {
    "question": "Have you built an AI program before?",
    "name": "built-ai",
    "options": [
      {
        "type": "radio",
        "text": "Yes. I do it professionally."
      },
      {
        "type": "radio",
        "text": "Yes. I have done it as my hobby/school project."
      },
      {
        "type": "radio",
        "text": "No."
      }
    ]
  },
  {
    "question": "Do you understand the purpose of this whole survey?",
    "name": "know-purpose",
    "options": [
      {
        "type": "radio",
        "text": "Yes."
      },
      {
        "type": "radio",
        "text": "Yes, but it is not clear to me."
      },
      {
        "type": "radio",
        "text": "No."
      }
    ]
  }];

  function createOption(type, name, text, otherOption) {
    if (otherOption) {
        return `
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <div class="input-group-text">
              <input type="${type}" name="${name}" value="" id="${name}-other" onclick="updatePdcOnElement(this, '${name}-other-text')">
            </div>
          </div>
          <input type="text"
                 stype="${type}"
                 name="${name}"
                 value=""
                 reference=""
                 update-check-on="${name}-other"
                 class="form-control"
                 id="${name}-other-text"
                 placeholder="Others (Type your answer here)"
                 onkeyup="document.getElementById('${name}-other').checked = true;updatePdcOnElement(this);">
        </div>
        `;
    }
    return `
    <div class="input-group mb-3">
      <div class="input-group-prepend">
        <div class="input-group-text">
          <input type="${type}"
                 stype="${type}"
                 name="${name}"
                 value="${text}"
                 onclick="updatePdcOnElement(this)">
        </div>
      </div>
      <span class="overflow-x-auto form-control">${text}</span>
    </div>
    `;
  }

  function updateProgressBar(prog) {
    $("#iframe-progress").css("width", `${prog}%`);
    $("#iframe-progress").attr("aria-valuenow", `${prog}`);
    if (prog == 100) {
      setTimeout(() => $("#progress-group").fadeOut(), 1000);
    }
  }

  $(document).ready(() => {
    randomizeOnClick();
    updateProgressBar(5);

    let y = $(document).scrollTop();
    let t = $("#vote").offset().top;
    if (y > t) {
      $("#complete-evaluation-button").fadeIn();
    } else {
      $("#complete-evaluation-button").fadeOut();
    }

    $(document).scroll(function() {
      let y = $(this).scrollTop();
      let t = $("#vote").offset().top;
      if (y > t) {
        $("#complete-evaluation-button").fadeIn();
      } else {
        $("#complete-evaluation-button").fadeOut();
      }
    });

    $(document).scroll(function() {
      let y = $(this).scrollTop();
      let t = $("#pdc-divider").offset().top - window.innerHeight;
      if (y > t) {
        if ($("#submit-button").html().trim() == COMPLETE_EVALUATION) {
          $("#submit-button").html(SKIP_PDC);
        }
      } else {
        if ($("#submit-button").html() == SKIP_PDC) {
          $("#submit-button").html(COMPLETE_EVALUATION);
        }
      }
    });
    $("#submit-button").html(COMPLETE_EVALUATION);

    $("input[type='radio']").prop("checked", false);
    $("input[type='checkbox']").prop("checked", false);
    $("input[type=text]").val("");


    pdcQuestions = shuffle(pdcQuestions);
    for (let pdc of pdcQuestions) {
      let options = "";
      let question = pdc.question;
      let name = pdc.name;
      for (let option of pdc.options) {
        options += createOption(option.type, name, option.text, option.otherOption);
      }
      let wrapper = `    <div class="form-group">
        <label for="${name}">${question}</label>
        ${options}
            </div>
      `;

      $("#pdc-section").append(wrapper);
    }
  });
</script>
